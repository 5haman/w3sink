(function(f){function l(s,t){for(var r in s){if(!t.hasOwnProperty(r)){t[r]=s[r]}}}function q(r,v){var u=/(\d+)(\w+)?/;var t=u.exec(v);return t[1]}function e(r){this.id=r;this.timeId=0;this.sinks=[]}e.prototype={addSink:function(r){this.sinks.push(r)},removeSink:function(r){},newTimeId:function(){return this.timeId++},sendNodeAdded:function(u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].nodeAdded(this.id,s,u)}},sendNodeRemoved:function(u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].nodeRemoved(this.id,s,u)}},sendNodeAttributeAdded:function(w,v,u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].nodeAttributeAdded(this.id,s,w,v,u)}},sendNodeAttributeChanged:function(x,v,r,w){var u=this.newTimeId();if(w===undefined){w=r}for(var s=0;s<this.sinks.length;s++){this.sinks[s].nodeAttributeChanged(this.id,u,x,v,r,w)}},sendNodeAttributeRemoved:function(v,u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].nodeAttributeRemoved(this.id,s,v,u)}},sendEdgeAdded:function(x,v,w,u){var s=this.newTimeId();if(u===undefined){u=false}for(var r=0;r<this.sinks.length;r++){this.sinks[r].edgeAdded(this.id,s,x,v,w,u)}},sendEdgeRemoved:function(u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].edgeRemoved(this.id,s,u)}},sendEdgeAttributeAdded:function(w,v,u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].edgeAttributeAdded(this.id,s,w,v,u)}},sendEdgeAttributeChanged:function(x,v,r,w){var u=this.newTimeId();if(w===undefined){w=r}for(var s=0;s<this.sinks.length;s++){this.sinks[s].edgeAttributeChanged(this.id,u,x,v,r,w)}},sendEdgeAttributeRemoved:function(v,u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].edgeAttributeRemoved(this.id,s,v,u)}},sendGraphAttributeAdded:function(v,u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].graphAttributeAdded(this.id,s,v)}},sendGraphAttributeChanged:function(v,r,w){var u=this.newTimeId();if(w===undefined){w=r}for(var s=0;s<this.sinks.length;s++){this.sinks[s].graphAttributeChanged(this.id,u,v,r,w)}},sendGraphAttributeRemoved:function(u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].graphAttributeRemoved(this.id,s,u)}},sendGraphCleared:function(){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].graphCleared(this.id,s)}},sendStepBegins:function(u){var s=this.newTimeId();for(var r=0;r<this.sinks.length;r++){this.sinks[r].stepBegins(this.id,s,u)}}};function d(){}d.prototype={nodeAdded:function(s,r,t){},nodeRemoved:function(s,r,t){},nodeAttributeAdded:function(u,r,v,t,s){},nodeAttributeChanged:function(u,s,w,t,r,v){},nodeAttributeRemoved:function(t,r,u,s){},edgeAdded:function(u,s,w,t,v,r){},edgeRemoved:function(s,r,t){},edgeAttributeAdded:function(u,r,v,t,s){},edgeAttributeChanged:function(u,s,w,t,r,v){},edgeAttributeRemoved:function(t,r,u,s){},graphAttributeAdded:function(u,r,t,s){},graphAttributeChanged:function(u,s,t,r,v){},graphAttributeRemoved:function(t,r,s){},graphCleared:function(s,r){},stepBegins:function(t,s,r){}};function b(s,r,t){this.id=t;this.type=r;this.graph=s;this.attributes={}}b.prototype={getAttribute:function(r){return this.attributes[r]},setAttribute:function(r,s){this.attributes[r]=s},hasAttribute:function(r){return this.attributes.hasOwnProperty(r)},removeAttribute:function(r){delete this.attributes[r]},setFill:function(r){},setStroke:function(r){},setStrokeWidth:function(r){},setSize:function(r){},setLabel:function(r){},setStyle:function(v){var w=v.split(/\s*;\s*/);for(var u=0;u<w.length;u++){if(w[u]===""){continue}var s=w[u].split(/\s*:\s*/);switch(s[0]){case"fill-color":var r=s[1].split(/\s*,\s*/);this.setFill(r[0]);break;case"stroke-color":var r=s[1].split(/\s*,\s*/);this.setStroke(r[0]);break;case"stroke-width":this.setStrokeWidth(q(this,s[1]));break;case"z-index":this.setZIndex(s[1]);break;case"size":this.setSize(q(this,s[1]));break;case"fill-image":case"fill-mode":case"stroke-mode":case"padding":case"shadow-mode":case"shadow-color":case"shadow-width":case"shadow-offset":case"text-mode":case"text-background-mode":case"text-visibility-mode":case"text-visibility":case"text-color":case"text-background-color":case"text-style":case"text-alignment":case"text-padding":case"text-offset":case"text-font":case"text-size":case"icon":case"icon-mode":case"visibility":case"visibility-mode":case"size-mode":case"shape":case"arrow-shape":case"arrow-image":case"arrow-size":case"shape-points":console.log("[GraphStream CSS] unsupported property '"+s[0]+"' for "+this.type);break;default:console.log("[GraphStream CSS] unknown property '"+s[0]+"' for "+this.type);break}}},updateShapePosition:function(){}};function j(r,s){b.call(this,r,"Node",s);this.edges={};this._x=0;this._y=0;this.pixelX=r.randomPixelX();this.pixelY=r.randomPixelY();this.index=r.indexedNodes.length;r.indexedNodes.push(this)}j.prototype={registerEdge:function(r){this.edges[r.id]=r},unregisterEdge:function(r){delete this.edges[r.id]},x:function(r){if(typeof(r)==="undefined"){return this._x}this._x=r;for(var s in this.edges){this.edges[s].nodePositionChanged(this)}},y:function(s){if(typeof(s)==="undefined"){return this._y}this._y=s;for(var r in this.edges){this.edges[r].nodePositionChanged(this)}},setXY:function(r,s){this._x=r;this._y=s;this.graph.viewbox.check(r,s);this.graph.viewbox.update(this)},setPixelXY:function(r,t){this.pixelX=r;this.pixelY=t;this.updateShapePosition();for(var s in this.edges){this.edges[s].nodePositionChanged()}return this}};function i(t,v,s,u,r){b.call(this,t,"Edge",v);this.source=s;this.target=u;this.directed=r;this.points=[{x:s.pixelX,y:s.pixelY},{x:u.pixelX,y:u.pixelY}];this.index=t.indexedEdges.length;t.indexedEdges.push(this)}i.prototype={nodePositionChanged:function(){this.points[0].x=this.source.pixelX;this.points[0].y=this.source.pixelY;this.points[this.points.length-1].x=this.target.pixelX;this.points[this.points.length-1].y=this.target.pixelY;this.updateShapePosition()}};l(b.prototype,j.prototype);l(b.prototype,i.prototype);function n(r,s){e.call(this,r);if(typeof(s)==="undefined"){s="default"}if(!g.hasOwnProperty(s)){throw new Error("context '"+s+"' is not registered")}this.context=new g[s](r);this.nodes={};this.edges={};this.indexedNodes=[];this.indexedEdges=[];this.default_node_style="fill-color:#89a9e3;size:10px;stroke-color:#333333;stroke-width:5px;";this.default_node_size=15;this.default_edge_style="stroke-color:#333333;stroke-width:2px;";this.viewbox=new h(this);this.dispatch=new d();this._width=jQuery(this.context.getContainer()).width();this._height=jQuery(this.context.getContainer()).height()}n.prototype={width:function(){return this._width},height:function(){return this._height},an:function(s){if(this.nodes.hasOwnProperty(s)){console.log("[warning] node exists '"+s+"'");return}var r=this.context.createNode(this,s);this.nodes[s]=r;r.setStyle(this.default_node_style);this.nodesCount++;this.sendNodeAdded(s)},cn:function(u,r,s){var t=this.nodes[u];if(s===undefined){t.removeAttribute(r);this.sendNodeAttributeRemoved(u,r)}else{if(r==="xy"||r==="xyz"){t.setXY(s[0],s[1])}else{if(r==="size"){t.setSize(s)}else{if(r==="style"){t.setStyle(s)}else{if(r==="label"){t.setLabel(s)}}}}t.setAttribute(r,s);this.sendNodeAttributeChanged(u,r,s)}},setXY:function(u,r,t){var s=this.nodes[u];s.setXY(r,t)},setPixelXY:function(u,r,t){var s=this.nodes[u];s.setPixelXY(r,t)},dn:function(y){var r=[];var x=this.nodes[y];for(var s in this.edges){if(this.edges[s].source.id==y||this.edges[s].target.id==y){r.push(this.edges[u])}}for(var u=0;u<r.length;u++){this.de(r[u].id)}this.sendNodeRemoved(y);this.context.removeNode(this,x);if(x.index===this.indexedNodes.length-1){this.indexedNodes.pop()}else{var v=this.indexedNodes[this.indexedNodes.length-1];var w=v.index,t=x.index;v.index=t;this.indexedNodes[t]=v;this.indexedNodes.pop();this.context.nodeIndexChanged(v,w,t)}delete this.nodes[y]},ae:function(v,u,r,s){if(this.nodes[u]===undefined){console.log("node '"+u+"' not found for edge '"+v+"'");return}if(this.nodes[r]===undefined){console.log("node '"+r+"' not found for edge '"+v+"'");return}var t=this.context.createEdge(this,v,this.nodes[u],this.nodes[r],s);this.edges[v]=t;t.setStyle(this.default_edge_style);this.nodes[u].edges[v]=t;this.nodes[r].edges[v]=t;this.edgesCount++;this.sendEdgeAdded(v,u,r,s)},ce:function(u,r,s){var t=this.edges[u];if(typeof(s)=="undefined"){t.removeAttribute(t);this.sendEdgeAttributeRemoved(u,r)}else{if(r==="style"){t.setStyle(s)}else{if(r==="size"){t.setSize(s)}}t.setAttribute(r,s);this.sendEdgeAttributeChanged(u,r,s)}},de:function(v){var t=this.edges[v];this.sendEdgeRemoved(v);this.context.removeEdge(this,t);delete t.source.edges[v];delete t.target.edges[v];if(t.index===this.indexedEdges.length-1){this.indexedEdges.pop()}else{var s=this.indexedEdges[this.indexedEdges.length-1];var u=s.index,r=t.index;s.index=r;this.indexedEdges[r]=s;this.indexedEdges.pop();this.context.edgeIndexChanged(s,u,r)}delete this.edges[v]},cg:function(s,r){},cl:function(){this.context.clear();this.sendGraphCleared()},st:function(r){this.sendStepBegins(r)},randomPixelX:function(r){if(r===undefined){r=Math.random()}return ~~(r*this.width())},randomPixelY:function(r){if(r===undefined){r=Math.random()}return ~~(r*this.height())},nodeAdded:function(s,r,t){this.an(t)},nodeRemoved:function(s,r,t){this.dn(t)},nodeAttributeAdded:function(u,s,v,r,t){this.cn(v,r,t)},nodeAttributeChanged:function(u,t,w,s,r,v){this.cn(w,s,v)},nodeAttributeRemoved:function(t,s,u,r){this.cn(u,r,value)},edgeAdded:function(t,s,u,w,v,r){this.ae(u,w,v,r)},edgeRemoved:function(s,r,t){this.de(t)},edgeAttributeAdded:function(u,s,v,r,t){this.ce(v,r,t)},edgeAttributeChanged:function(u,t,w,s,r,v){this.ce(w,s,v)},edgeAttributeRemoved:function(t,s,u,r){this.ce(u,r,value)},graphAttributeAdded:function(u,s,r,t){this.cg(r,t)},graphAttributeChanged:function(u,t,s,r,v){this.cg(s,v)},graphAttributeRemoved:function(t,s,r){this.cg(r,value)},graphCleared:function(s,r){this.cl()},stepBegins:function(t,s,r){this.st(r)}};l(e.prototype,n.prototype);function p(r){this.container=document.querySelector(r)}p.prototype={getContainer:function(){return this.container},createNode:function(r,s){return new j(r,s)},removeNode:function(s,r){},createEdge:function(t,v,s,u,r){return new i(t,v,s,u,r)},removeEdge:function(s,r){},clear:function(r){},zoom:function(r){},nodeIndexChanged:function(s,t,r){},edgeIndexChanged:function(s,t,r){}};function h(r){this.graph=r;this.minx=Infinity;this.miny=Infinity;this.maxx=-Infinity;this.maxy=-Infinity;this.padding={top:15,right:15,bottom:15,left:15}}h.prototype={reset:function(){this.minx=Infinity;this.miny=Infinity;this.maxx=-Infinity;this.maxy=-Infinity},check:function(r,t){var s=false;if(r<this.minx){s=true;this.minx=r}if(t<this.miny){s=true;this.miny=t}if(r>this.maxx){s=true;this.maxx=r}if(t>this.maxy){s=true;this.maxy=t}if(s){if(this.minx===this.maxx){this.minx-=0.1;this.maxx+=0.1}if(this.miny===this.maxy){this.miny-=0.1;this.maxy+=0.1}this.update()}},compute:function(){var u,t,r,w;u=t=Infinity;r=w=-Infinity;for(var v in this.graph.nodes){var s=this.graph.nodes[v];u=Math.min(u,s._x);t=Math.min(t,s._y);r=Math.max(r,s._x);w=Math.max(w,s._y)}this.minx=u;this.miny=t;this.maxx=r;this.maxy=w;this.update()},update:function(t){if(t===undefined){for(var u in this.graph.nodes){this.update(this.graph.nodes[u])}}else{var s=(t._x-this.minx)/(this.maxx-this.minx),r=(t._y-this.miny)/(this.maxy-this.miny);s=this.padding.left+(this.graph.width()-this.padding.left-this.padding.right)*s;r=this.padding.bottom+(this.graph.height()-this.padding.bottom-this.padding.top)*r;t.setPixelXY(s,r)}}};var g={"default":p};function k(r,s){g[r]=s}var c={method:"GET",responseType:""};function a(r){l(c,r);var s=new XMLHttpRequest();s.open(r.method,r.url,true);s.responseType=r.responseType;s.send();return s}function o(r){e.call(this,r);this.type=r}o.prototype={begin:function(r){},nextEvents:function(){},nextStep:function(){},end:function(){}};l(e.prototype,o.prototype);var m={extend:l,Node:j,Edge:i,Graph:n,Context:p,Source:e,Sink:d,FileSource:o,registerContext:k};f.GS=m}(this));(function(a){var e={ns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink"};function d(f,g){GS.Node.call(this,f,g);this.shape={g:document.createElementNS(e.ns,"g"),node:document.createElementNS(e.ns,"circle"),title:document.createElementNS(e.ns,"title"),label:document.createElementNS(e.ns,"text"),labelText:document.createTextNode(""),labelStroke:document.createElementNS(e.ns,"text"),labelStrokeText:document.createTextNode("")};this.shape.g.setAttribute("transform","translate("+this.pixelX+","+this.pixelY+")");this.shape.node.setAttribute("class","node");this.shape.node.setAttribute("r",f.default_node_size);this.shape.node.setAttribute("cx",0);this.shape.node.setAttribute("cy",0);this.shape.node.setAttribute("fill","black");this.shape.node.setAttribute("stroke","white");this.shape.node.setAttribute("stroke-width","2px");this.shape.title.textContent=g;this.shape.label.setAttribute("font-size","12px");this.shape.label.setAttribute("fill","#ff7200");this.shape.labelStroke.setAttribute("font-size","12px");this.shape.labelStroke.setAttribute("fill","#ff7200");this.shape.labelStroke.setAttribute("stroke","#222222");this.shape.labelStroke.setAttribute("stroke-width",5);this.shape.label.appendChild(this.shape.labelText);this.shape.labelStroke.appendChild(this.shape.labelStrokeText);this.shape.g.appendChild(this.shape.node);this.shape.g.appendChild(this.shape.title);this.shape.g.appendChild(this.shape.labelStroke);this.shape.g.appendChild(this.shape.label);f.context.gnodes.appendChild(this.shape.g)}d.prototype={setFill:function(f){this.shape.node.setAttribute("fill",f)},setStroke:function(f){this.shape.node.setAttribute("stroke",f)},setStrokeWidth:function(f){this.shape.node.setAttribute("stroke-width",f)},setSize:function(f){this.shape.node.setAttribute("r",f)},setLabel:function(f){if(f===undefined){f=this.id}this.shape.labelText.textContent=f;this.shape.labelStrokeText.textContent=f},updateShapePosition:function(){this.shape.g.setAttribute("transform","translate("+this.pixelX+","+this.pixelY+")");if(this.pixelX<this.graph.width()/2){this.shape.label.setAttribute("text-anchor","start");this.shape.labelStroke.setAttribute("text-anchor","start")}else{this.shape.label.setAttribute("text-anchor","end");this.shape.labelStroke.setAttribute("text-anchor","end")}}};function c(h,j,g,i,f){GS.Edge.call(this,h,j,g,i,f);this.shape=document.createElementNS(e.ns,"line");this.shape.setAttribute("class","edge");this.shape.setAttribute("x1",g.pixelX);this.shape.setAttribute("y1",g.pixelY);this.shape.setAttribute("x2",i.pixelX);this.shape.setAttribute("y2",i.pixelY);this.shape.setAttribute("stroke","black");this.shape.setAttribute("stroke-width","1px");h.context.gedges.appendChild(this.shape)}c.prototype={setStroke:function(f){this.shape.setAttribute("stroke",f)},setStrokeWidth:function(f){this.shape.setAttribute("stroke-width",f)},setSize:function(f){this.setStrokeWidth(f)},updateShapePosition:function(){this.shape.setAttribute("x1",this.points[0].x);this.shape.setAttribute("y1",this.points[0].y);this.shape.setAttribute("x2",this.points[this.points.length-1].x);this.shape.setAttribute("y2",this.points[this.points.length-1].y)}};GS.extend(GS.Node.prototype,d.prototype);GS.extend(GS.Edge.prototype,c.prototype);function b(f){GS.Context.call(this,f);this.svg=document.createElementNS(e.ns,"svg:svg");this.svg.setAttribute("width","100%");this.svg.setAttribute("height","100%");this.svg.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",e.xlinkns);this.container.appendChild(this.svg);this.root=document.createElementNS(e.ns,"g");this.gedges=document.createElementNS(e.ns,"g");this.gnodes=document.createElementNS(e.ns,"g");this.root.appendChild(this.gedges);this.root.appendChild(this.gnodes);this.svg.appendChild(this.root)}b.prototype={createNode:function(f,g){var h=new d(f,g);return h},removeNode:function(g,f){this.gnodes.removeChild(f.shape.g)},createEdge:function(h,k,g,j,f){var i=new c(h,k,g,j,f);return i},removeEdge:function(g,f){this.gedges.removeChild(f.shape)},clear:function(f){},zoom:function(f){this.svg.setAttribute("transform","scale("+f+")")}};a.GS.extend(GS.Context.prototype,b.prototype);a.GS.registerContext("svg",b)}(this));(function(a){function e(f,g){GS.Node.call(this,f,g);this.shape=new Kinetic.Circle({x:f.randomPixelX(),y:f.randomPixelY(),radius:15,fill:"black",stroke:"white",strokeWidth:2})}e.prototype={updateShapePosition:function(){this.shape.setX(this.pixelX);this.shape.setY(this.pixelY);this.graph.context.layers.drawLayerOf(this)},setFill:function(f){this.shape.setFill(f)},setStroke:function(f){this.shape.setStroke(f)},setStrokeWidth:function(f){this.shape.setStrokeWidth(f)},setSize:function(f){this.shape.setRadius(f)}};GS.extend(GS.Node.prototype,e.prototype);function d(h,j,g,i,f){GS.Edge.call(this,h,j,g,i,f);this.shape=new Kinetic.Line({points:this.points,stroke:"black",strokeWidth:2,lineJoin:"round",lineCap:"round"})}d.prototype={updateShapePosition:function(){this.shape.setPoints(this.points);this.graph.context.layers.drawLayerOf(this)},setFill:function(f){this.shape.setFill(f)},setStroke:function(f){this.shape.setStroke(f)},setStrokeWidth:function(f){this.shape.setStrokeWidth(f)}};GS.extend(GS.Edge.prototype,d.prototype);function c(h,k,g){c.prototype.layers.push(this);if(k===undefined){k=4}if(g===undefined){g=k}this.stage=h;this.drag=new Kinetic.Layer("drag");this.dragEdges=new Kinetic.Layer("dragEdges");this.nodes=[];this.edges=[];for(var j=0;j<g;j++){var f=new Kinetic.Layer("edges#"+j);f.changed=true;this.edges.push(f);this.stage.add(f)}this.stage.add(this.dragEdges);for(var j=0;j<k;j++){var f=new Kinetic.Layer("nodes#"+j);f.changed=true;this.nodes.push(f);this.stage.add(f)}this.stage.add(this.drag)}c.prototype.layers=[];c.prototype.addNode=function(g){var f=~~(Math.random()*this.nodes.length);this.nodes[f].add(g.shape);this.nodes[f].changed=true};c.prototype.addEdge=function(f){var g=~~(Math.random()*this.edges.length);this.edges[g].add(f.shape);this.edges[g].changed=true};c.prototype.removeNode=function(g){var f=g.shape.getLayer();f.remove(g.shape);f.changed=true};c.prototype.removeEdge=function(g){var f=g.shape.getLayer();f.remove(g.shape);f.changed=true};c.prototype.drawLayerOf=function(f){f.shape.getLayer().changed=true};c.prototype.drawAll=function(){for(var f=0;f<this.edges.length;f++){if(this.edges[f].changed){this.edges[f].draw();this.edges[f].changed=false}}for(var f=0;f<this.nodes.length;f++){if(this.nodes[f].changed){this.nodes[f].draw();this.nodes[f].changed=false}}};c.prototype.dragStart=function(j){this.__beforeDragLayer=j.shape.getLayer();j.shape.moveTo(this.drag);j.shape.draggable(true);for(var h=0;h<this.nodes.length;h++){this.nodes[h].listen(false)}for(var g in j.edges){var f=j.edges[g].shape.getLayer();j.edges[g].shape.moveTo(this.dragEdges);f.draw()}this.__beforeDragLayer.draw();this.drag.draw();this.dragEdges.draw()};c.prototype.dragEnd=function(h){h.shape.moveTo(this.__beforeDragLayer);h.shape.draggable(false);for(var g=0;g<this.nodes.length;g++){this.nodes[g].listen(true)}for(var f in h.edges){var j=~~(Math.random()*this.edges.length);h.edges[f].shape.moveTo(this.edges[j]);this.edges[j].draw()}this.__beforeDragLayer.draw();this.drag.draw();this.dragEdges.draw()};function b(f){GS.Context.call(this,f);this.stage=new Kinetic.Stage({container:this.container,width:$(this.container).width(),height:$(this.container).height()});this.layers=new c(this.stage)}b.prototype={createNode:function(f,g){var h=new e(f,g);this.layers.addNode(h);return h},removeNode:function(g,f){this.layers.removeNode(f)},createEdge:function(h,k,g,j,f){var i=new d(h,k,g,j,f);this.layers.addEdge(i);return i},removeEdge:function(g,f){this.layers.removeEdge(f)},clear:function(f){}};a.GS.extend(GS.Context.prototype,b.prototype);setInterval(function(){for(var f=0;f<c.prototype.layers.length;f++){c.prototype.layers[f].drawAll()}},25);a.GS.registerContext("canvas",b)}(this));(function(a){function c(d){this.graph=d;this.nodes=[];this.links=[];this.graph.addSink(this);for(var e in this.graph.nodes){this.registerNode(e)}for(var e in this.graph.edges){this.registerEdge(e)}}c.prototype={start:function(){},reload:function(){},stop:function(){},registerNode:function(e){var d=this.graph.nodes[e];d.layoutIndex=this.nodes.length;this.nodes.push({id:e})},unregisterNode:function(e){var d=this.graph.nodes[e];this.nodes.splice(d.layoutIndex,1)},registerEdge:function(f){var d=this.graph.edges[f];d.layoutIndex=this.links.length;this.links.push({id:f,source:this.nodes[d.source.layoutIndex],target:this.nodes[d.target.layoutIndex],value:1})},unregisterEdge:function(f){var d=this.graph.edges[f];this.links.splice(d.layoutIndex,1)},nodeAdded:function(e,d,f){this.registerNode(f);this.reload()},nodeRemoved:function(e,d,f){this.unregisterNode(f);this.reload()},edgeAdded:function(g,e,i,f,h,d){this.registerEdge(i);this.reload()},edgeRemoved:function(e,d,f){this.unregisterEdge(f);this.reload()},graphCleared:function(e,d){this.nodes=[];this.links=[];this.reload()},pushXY:function(){for(var d=0;d<this.nodes.length;d++){this.graph.setXY(this.nodes[d].id,this.nodes[d].x,this.nodes[d].y)}},nodeAttributeAdded:function(g,d,h,f,e){},nodeAttributeChanged:function(g,e,i,f,d,h){},nodeAttributeRemoved:function(f,d,g,e){},edgeAttributeAdded:function(g,d,h,f,e){},edgeAttributeChanged:function(g,e,i,f,d,h){},edgeAttributeRemoved:function(f,d,g,e){},graphAttributeAdded:function(g,d,f,e){},graphAttributeChanged:function(g,e,f,d,h){},graphAttributeRemoved:function(f,d,e){},stepBegins:function(f,e,d){}};GS.extend(GS.Sink.prototype,c.prototype);function b(e){c.call(this,e);this.layout_running=false;this.layout=d3.layout.force().gravity(0).charge(-15).linkDistance(30);var d=this;this.layout.on("tick",function(){d.pushXY()})}b.prototype={start:function(){this.layout_running=true;this.reload()},reload:function(){if(this.layout_running){this.layout.stop()}this.layout.nodes(this.nodes).links(this.links);if(this.layout_running){this.layout.start()}},stop:function(){this.layout_running=false;this.layout.stop()}};GS.extend(c.prototype,b.prototype);a.GS.Layout=c;a.GS.ForceLayout=b}(this));(function(b){function a(){GS.FileSource.call(this,"json");this.data=false;this.lastEvent=false}a.prototype={begin:function(c){var d=this;jQuery.ajax({url:c,type:"GET",dataType:"json",async:false,success:function(e){d.setData(e)}})},setData:function(c){this.data=c;this.data.events.reverse()},nextEvents:function(){if(!this.data){console.log("no data");return}var g=this.data.events.pop();g.reverse();var c=g.pop();switch(c){case"an":this.sendNodeAdded(g.pop());break;case"cn":var h=g.pop();var f;while(g.length>0){var d="";f=g.pop();if(f[0]==="+"||f[0]==="-"||f[0]===""){d=f[0];f.splice(0,1)}switch(d){case"":if(g.length===2){g.push(g[1])}this.sendNodeAttributeChanged(h,g[0],g[1],g[2]);break;case"+":this.sendNodeAttributeAdded(h,g[0],g[1]);break;case"-":this.sendNodeAttributeRemoved(h,g[0]);break}}break;case"dn":this.sendNodeRemoved(g.pop());break;case"ae":this.sendEdgeAdded(g.pop(),g.pop(),g.pop(),g.length>0?g.pop():false);break;case"ce":var h=g.pop();var f;while(g.length>0){var d="";f=g.pop();if(f[0]==="+"||f[0]==="-"||f[0]===""){d=f[0];f.splice(0,1)}switch(d){case"":if(g.length===2){g.push(g[1])}this.sendEdgeAttributeChanged(h,g[0],g[1],g[2]);break;case"+":this.sendEdgeAttributeAdded(h,g[0],g[1]);break;case"-":this.sendEdgeAttributeRemoved(h,g[0]);break}}break;case"de":this.sendEdgeRemoved(g.pop());break;case"cg":var f;while(g.length>0){var d="";f=g.pop();if(f[0]==="+"||f[0]==="-"||f[0]===""){d=f[0];f.splice(0,1)}switch(d){case"":if(g.length===2){g.push(g[1])}this.sendGraphAttributeChanged(g[0],g[1],g[2]);break;case"+":this.sendGraphAttributeAdded(g[0],g[1]);break;case"-":this.sendGraphAttributeRemoved(g[0]);break}}break;case"st":this.sendStepBegins(g.pop());break;case"cl":this.sendGraphCleared();break;default:console.log("unknown event '"+c+"'")}this.lastEvent=c;return this.data.events.length>0},nextStep:function(){while(this.lastEvent!="st"&&this.data.events.length>0){this.nextEvents()}return this.data.events.length>0},end:function(){this.data=false;this.lastEvent=false}};GS.extend(GS.FileSource.prototype,a.prototype);GS.JSONSource=a}(this));